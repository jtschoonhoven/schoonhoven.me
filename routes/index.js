
/*
 * GET home page.
 */

exports.index = function(req, res){
  res.render('index', { 
    tableObj: JSON.stringify({"reach_report": {"name":"reach_report","title":"Reach Report","created_at":"2013-12-23","description":"Number of emails received by eligible users over the last 30 days","chartType":"table","location":"./queries/reach_report.sql","query":"SELECT\n  n AS thirty_day_aas_received\n, SUM(CASE WHEN country = 'US' THEN n ELSE 0 END) AS US\n, SUM(CASE WHEN country = 'CA' THEN n ELSE 0 END) AS CA\n, SUM(CASE WHEN country = 'DE' THEN n ELSE 0 END) AS DE\n, SUM(CASE WHEN country = 'ES' THEN n ELSE 0 END) AS ES\n, SUM(CASE WHEN country = 'FR' THEN n ELSE 0 END) AS FR\n, SUM(CASE WHEN country = 'GB' THEN n ELSE 0 END) AS GB\n, SUM(CASE WHEN country = 'IT' THEN n ELSE 0 END) AS IT\n, SUM(CASE WHEN country = 'BY' THEN n ELSE 0 END) AS BY\n, SUM(CASE WHEN country = 'RU' THEN n ELSE 0 END) AS RU\n, SUM(CASE WHEN country = 'TR' THEN n ELSE 0 END) AS TR\n, SUM(CASE WHEN country = 'UA' THEN n ELSE 0 END) AS UA\n, SUM(CASE WHEN country = 'AR' THEN n ELSE 0 END) AS AR\n, SUM(CASE WHEN country = 'BR' THEN n ELSE 0 END) AS BR\n, SUM(CASE WHEN country = 'MX' THEN n ELSE 0 END) AS MX\n, SUM(CASE WHEN country = 'AU' THEN n ELSE 0 END) AS AU\n, SUM(CASE WHEN country = 'IN' THEN n ELSE 0 END) AS IN\n, SUM(CASE WHEN country = 'JP' THEN n ELSE 0 END) AS JP\n, SUM(CASE WHEN country = 'PH' THEN n ELSE 0 END) AS PH\n, SUM(CASE WHEN country = 'TH' THEN n ELSE 0 END) AS TH\n, SUM(CASE WHEN country = 'ID' THEN n ELSE 0 END) AS ID\nFROM (\n  SELECT el.id, u.country, COUNT(1) AS n\n  FROM eligible_users el\n  JOIN users u ON u.id = el.id\n  LEFT JOIN individual_alert_records iar ON iar.user_id = el.id\n  WHERE u.country IN ('US', 'CA', 'DE', 'ES', 'FR', 'GB', 'IT', 'BY', 'RU', 'TR', 'UA', 'AR', 'BR', 'MX', 'AU', 'IN', 'JP', 'PH', 'TH', 'ID')\n  AND u.created_at < CURRENT_DATE - INTERVAL '30 DAYS'\n  AND iar.created_at >= CURRENT_DATE - INTERVAL '30 DAYS'\n  GROUP BY el.id, u.country\n  )\nGROUP BY n\nORDER BY n;","rows":[[{"name":"thirty_day_aas_received","value":1},{"name":"us","value":47150},{"name":"ca","value":2953},{"name":"de","value":1122},{"name":"es","value":2593},{"name":"fr","value":2397},{"name":"gb","value":4809},{"name":"it","value":2634},{"name":"by","value":1315},{"name":"ru","value":85657},{"name":"tr","value":1660},{"name":"ua","value":837},{"name":"ar","value":1593},{"name":"br","value":13116},{"name":"mx","value":298773},{"name":"au","value":2961},{"name":"in","value":450},{"name":"jp","value":428},{"name":"ph","value":208},{"name":"th","value":1106},{"name":"id","value":435}],[{"name":"thirty_day_aas_received","value":2},{"name":"us","value":404358},{"name":"ca","value":8114},{"name":"de","value":170762},{"name":"es","value":8420},{"name":"fr","value":4040},{"name":"gb","value":30342},{"name":"it","value":8576},{"name":"by","value":237980},{"name":"ru","value":1635450},{"name":"tr","value":3582},{"name":"ua","value":646},{"name":"ar","value":3516},{"name":"br","value":656874},{"name":"mx","value":667132},{"name":"au","value":211816},{"name":"in","value":1486},{"name":"jp","value":2572},{"name":"ph","value":234},{"name":"th","value":3294},{"name":"id","value":1098}],[{"name":"thirty_day_aas_received","value":3},{"name":"us","value":4854759},{"name":"ca","value":405366},{"name":"de","value":1187199},{"name":"es","value":292179},{"name":"fr","value":1560150},{"name":"gb","value":186492},{"name":"it","value":123822},{"name":"by","value":13011},{"name":"ru","value":942507},{"name":"tr","value":282819},{"name":"ua","value":2445},{"name":"ar","value":550506},{"name":"br","value":1435077},{"name":"mx","value":478242},{"name":"au","value":657918},{"name":"in","value":12426},{"name":"jp","value":44934},{"name":"ph","value":813},{"name":"th","value":2120727},{"name":"id","value":37881}],[{"name":"thirty_day_aas_received","value":4},{"name":"us","value":7769904},{"name":"ca","value":2018720},{"name":"de","value":1503460},{"name":"es","value":2090908},{"name":"fr","value":2978924},{"name":"gb","value":2482672},{"name":"it","value":1303512},{"name":"by","value":108},{"name":"ru","value":113232},{"name":"tr","value":1779196},{"name":"ua","value":478000},{"name":"ar","value":712100},{"name":"br","value":875372},{"name":"mx","value":169428},{"name":"au","value":790536},{"name":"in","value":1173948},{"name":"jp","value":219020},{"name":"ph","value":221188},{"name":"th","value":80},{"name":"id","value":375684}],[{"name":"thirty_day_aas_received","value":5},{"name":"us","value":4490680},{"name":"ca","value":1637085},{"name":"de","value":1030080},{"name":"es","value":4425650},{"name":"fr","value":1054970},{"name":"gb","value":3897885},{"name":"it","value":3878065},{"name":"by","value":15},{"name":"ru","value":10020},{"name":"tr","value":79110},{"name":"ua","value":247500},{"name":"ar","value":1200035},{"name":"br","value":560430},{"name":"mx","value":10165},{"name":"au","value":1152365},{"name":"in","value":800660},{"name":"jp","value":235045},{"name":"ph","value":244615},{"name":"th","value":70},{"name":"id","value":271910}],[{"name":"thirty_day_aas_received","value":6},{"name":"us","value":3032502},{"name":"ca","value":623412},{"name":"de","value":326694},{"name":"es","value":4503510},{"name":"fr","value":449730},{"name":"gb","value":1679292},{"name":"it","value":542148},{"name":"by","value":18},{"name":"ru","value":972},{"name":"tr","value":42180},{"name":"ua","value":1410},{"name":"ar","value":371538},{"name":"br","value":55854},{"name":"mx","value":558},{"name":"au","value":848058},{"name":"in","value":87588},{"name":"jp","value":25464},{"name":"ph","value":127932},{"name":"th","value":12},{"name":"id","value":52680}],[{"name":"thirty_day_aas_received","value":7},{"name":"us","value":2353183},{"name":"ca","value":70896},{"name":"de","value":147742},{"name":"es","value":2055270},{"name":"fr","value":214900},{"name":"gb","value":752493},{"name":"it","value":212534},{"name":"by","value":0},{"name":"ru","value":42},{"name":"tr","value":105},{"name":"ua","value":0},{"name":"ar","value":316883},{"name":"br","value":1204},{"name":"mx","value":42},{"name":"au","value":544117},{"name":"in","value":5362},{"name":"jp","value":7},{"name":"ph","value":38486},{"name":"th","value":7},{"name":"id","value":5040}],[{"name":"thirty_day_aas_received","value":8},{"name":"us","value":2234704},{"name":"ca","value":416},{"name":"de","value":67744},{"name":"es","value":757800},{"name":"fr","value":74544},{"name":"gb","value":582408},{"name":"it","value":89136},{"name":"by","value":0},{"name":"ru","value":8},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":153936},{"name":"br","value":0},{"name":"mx","value":24},{"name":"au","value":316320},{"name":"in","value":72},{"name":"jp","value":0},{"name":"ph","value":12872},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":9},{"name":"us","value":2157957},{"name":"ca","value":0},{"name":"de","value":25677},{"name":"es","value":279405},{"name":"fr","value":21330},{"name":"gb","value":374643},{"name":"it","value":29952},{"name":"by","value":0},{"name":"ru","value":9},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":86049},{"name":"br","value":9},{"name":"mx","value":27},{"name":"au","value":168993},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":2907},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":10},{"name":"us","value":1884900},{"name":"ca","value":20},{"name":"de","value":6000},{"name":"es","value":61590},{"name":"fr","value":2420},{"name":"gb","value":243940},{"name":"it","value":7440},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":33590},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":72690},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":310},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":11},{"name":"us","value":1595748},{"name":"ca","value":0},{"name":"de","value":682},{"name":"es","value":6468},{"name":"fr","value":330},{"name":"gb","value":187154},{"name":"it","value":671},{"name":"by","value":0},{"name":"ru","value":11},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":16148},{"name":"br","value":0},{"name":"mx","value":11},{"name":"au","value":30272},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":12},{"name":"us","value":1452360},{"name":"ca","value":0},{"name":"de","value":48},{"name":"es","value":348},{"name":"fr","value":24},{"name":"gb","value":149820},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":3204},{"name":"br","value":0},{"name":"mx","value":12},{"name":"au","value":7776},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":13},{"name":"us","value":1825707},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":115739},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":221},{"name":"br","value":0},{"name":"mx","value":13},{"name":"au","value":1040},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":14},{"name":"us","value":6709682},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":83300},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":14},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":112},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":15},{"name":"us","value":3335910},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":50400},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":0},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":30},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":16},{"name":"us","value":1334096},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":21696},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":0},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":0},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":17},{"name":"us","value":565267},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":5899},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":0},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":0},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":18},{"name":"us","value":174096},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":954},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":0},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":0},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":19},{"name":"us","value":35815},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":152},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":0},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":0},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":20},{"name":"us","value":4600},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":20},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":0},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":0},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":21},{"name":"us","value":315},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":0},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":0},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":0},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}],[{"name":"thirty_day_aas_received","value":22},{"name":"us","value":44},{"name":"ca","value":0},{"name":"de","value":0},{"name":"es","value":0},{"name":"fr","value":0},{"name":"gb","value":0},{"name":"it","value":0},{"name":"by","value":0},{"name":"ru","value":0},{"name":"tr","value":0},{"name":"ua","value":0},{"name":"ar","value":0},{"name":"br","value":0},{"name":"mx","value":0},{"name":"au","value":0},{"name":"in","value":0},{"name":"jp","value":0},{"name":"ph","value":0},{"name":"th","value":0},{"name":"id","value":0}]]}})
  });
};